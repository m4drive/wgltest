<html>
<head>
	<meta charset="utf-8">
	<title>WebGL Test</title>
	<script src="scripts/webgl-utils.js" type="text/javascript"></script>
	<script src="scripts/glMatrix-0.9.5.min.js" type="text/javascript"></script>
	<script src="scripts/wgl.js" type="text/javascript"></script>
	<script src="scripts/wgl.lib.shaders.js" type="text/javascript"></script>
	<script src="scripts/wgl.lib.primitives.js" type="text/javascript"></script>
</head>
<body>

<canvas id="webgl_content" width="1400px" height="900px" style="border: none;"></canvas>

<script>
	
	var container = document.getElementById("webgl_content");
	var instance = new WGL.Instance(container);
	
	obj = new WGL.Lib.Primitives.Sphere(100,100,1);
	obj.shaders=[new WGL.Lib.Shaders.FragmentShader.Textured(),new WGL.Lib.Shaders.VertexShader.Textured()]
	obj.textureSrc="images/tokyo.jpg";
	obj.position=[0,0,-2];
	obj.scale=[5,5,5];
	instance.objects.push(obj);
	
	instance.prepare();
	
	//rotation
	var mouseDown = false;
    var lastMouseX = null;
    var lastMouseY = null;
	
	container.onmousedown = handleMouseDown;
	document.onmouseup = handleMouseUp;
	document.onmousemove = handleMouseMove;
	
	function handleMouseDown(event) {
        mouseDown = true;
        lastMouseX = event.clientX;
        lastMouseY = event.clientY;
    }
    function handleMouseUp(event) {
        mouseDown = false;
    }
    function handleMouseMove(event) {
        if (!mouseDown) {
            return;
        }
        var newX = event.clientX;
        var newY = event.clientY;
        var deltaX = newX - lastMouseX
		instance.objects[0].rotation[1]+=deltaX/10;
        var deltaY = newY - lastMouseY;
		instance.objects[0].rotation[0]+=deltaY/5;
        lastMouseX = newX
        lastMouseY = newY;
    }
	
	tick();
	
	function tick() {
        requestAnimFrame(tick);
        instance.drawScene();
    }
</script>

</body>
</html>